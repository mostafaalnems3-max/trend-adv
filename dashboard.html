<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trend Adv | Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙƒØ§Ù„Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --main: #00bcd4; --bg: #f4f7f6; --white: #ffffff; --text: #333; --warning: #ff9800; --danger: #f44336; --success: #4caf50; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 0; }
        .header { background: #1a1a1a; color: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; }
        .container { max-width: 900px; margin: 30px auto; padding: 20px; }
        
        .card { background: var(--white); padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .step-title { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; color: var(--main); }
        
        .form-group { margin-bottom: 15px; }
        label { font-size: 13px; font-weight: bold; display: block; margin-bottom: 8px; }
        input[type="text"], input[type="tel"], input[type="file"] { width: 100%; padding: 12px; border: 1.5px solid #eee; border-radius: 12px; box-sizing: border-box; }
        
        .btn-primary { width: 100%; background: var(--main); color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .gps-btn { background: var(--success); color: white; border: none; padding: 10px; border-radius: 8px; width: 100%; margin-top: 5px; cursor: pointer; }
        
        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø·ÙˆØ± */
        .table-container { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; text-align: right; min-width: 600px; }
        th { background: #f8f9fa; padding: 15px 10px; border-bottom: 2px solid #eee; color: #555; }
        td { padding: 15px 10px; border-bottom: 1px solid #eee; vertical-align: middle; }
        
        .stat-box { font-weight: bold; font-size: 14px; color: var(--main); display: flex; align-items: center; gap: 5px; }
        .click-box { font-weight: bold; font-size: 14px; color: var(--success); display: flex; align-items: center; gap: 5px; }
        
        .status-badge { padding: 5px 12px; border-radius: 15px; font-size: 11px; font-weight: bold; display: inline-block; }
        .status-free { background: #e8f5e9; color: #2e7d32; }
        .status-expired { background: #ffebee; color: #c62828; }

        .hidden { display: none; }
        .badge { background: #e1f5fe; color: var(--main); padding: 5px 15px; border-radius: 20px; font-size: 12px; margin-top: 10px; display: inline-block; }
        
        .countdown { font-weight: bold; color: var(--text); }
        .urgent { color: var(--danger); animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

<header class="header">
    <div style="font-weight: bold;">Trend Adv <span style="font-size: 12px; opacity: 0.7;">Business Center</span></div>
    <a href="index.html" style="color:white; text-decoration:none; font-size:13px;">Ø®Ø±ÙˆØ¬</a>
</header>

<div class="container">

    <div id="agencyStep" class="card">
        <div class="step-title"><i class="fas fa-building"></i> <h3>Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙƒØ§Ù„Ø©</h3></div>
        <div class="form-group">
            <label>Ø§Ø³Ù… Ø§Ù„ÙˆÙƒØ§Ù„Ø©:</label>
            <input type="text" id="reg_agencyName" placeholder="Ù…Ø«Ø§Ù„: ÙˆÙƒØ§Ù„Ø© ØªØ±Ù†Ø¯ Ù„Ù„Ø¯Ø¹Ø§ÙŠØ©">
        </div>
        <div class="form-group">
            <label>Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„ÙˆÙƒØ§Ù„Ø© (Ø§Ù„Ø±Ø³Ù…ÙŠ):</label>
            <input type="tel" id="reg_agencyPhone" placeholder="010xxxxxxxx">
        </div>
        <button class="btn-primary" onclick="saveAgency()">Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙƒØ§Ù„Ø© ÙˆØ§Ù„Ø¨Ø¯Ø¡ ğŸš€</button>
    </div>

    <div id="sitesStep" class="card hidden">
        <div class="step-title"><i class="fas fa-chart-line"></i> <h3>Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3></div>
        <div id="agencyBadge" class="badge">Ø§Ù„ÙˆÙƒØ§Ù„Ø©: <span id="currentAgencyName"></span></div>
        
        <form id="uploadForm" style="margin-top:20px; background: #fafafa; padding: 20px; border-radius: 15px; border: 1px dashed #ddd;">
            <div class="form-group">
                <label>ÙˆØµÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</label>
                <input type="text" name="siteName" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù„ÙˆØ­Ø© Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¬ÙŠØ´ - Ø³Ø¨ÙˆØ±ØªÙ†Ø¬" required>
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ:</label>
                <input type="text" id="locationInput" name="location" readonly placeholder="ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª">
                <button type="button" class="gps-btn" onclick="getLocation()"><i class="fas fa-map-marker-alt"></i> ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¢Ù†</button>
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙˆØ§Ù„ØµÙˆØ±:</label>
                <input type="file" name="img1" accept="image/*" required style="margin-bottom:8px;">
                <input type="file" name="qr" accept="image/*" required>
            </div>
            <button type="submit" class="btn-primary" id="submitBtn">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø£ÙˆÙ„ 3 Ø´Ù‡ÙˆØ± Ù…Ø¬Ø§Ù†Ø§Ù‹) ğŸ</button>
        </form>

        <div class="table-container">
            <h4 style="margin-top: 40px; border-right: 4px solid var(--main); padding-right: 10px;">ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ù„ÙˆØ­Ø§ØªÙŠ</h4>
            <table id="mySitesTable">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                        <th>ğŸ‘ï¸ Ù…Ø´Ø§Ù‡Ø¯Ø©</th>
                        <th>ğŸ’¬ ØªÙˆØ§ØµÙ„</th>
                        <th>â³ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    </tr>
                </thead>
                <tbody id="sitesList">
                    </tbody>
            </table>
        </div>

        <button onclick="resetAgency()" style="background:none; border:none; color:#999; font-size:11px; margin-top:25px; cursor:pointer; text-decoration: underline;">ØªØºÙŠÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙƒØ§Ù„Ø© (ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯)</button>
    </div>
</div>

<script>
    function saveAgency() {
        const name = document.getElementById('reg_agencyName').value;
        const phone = document.getElementById('reg_agencyPhone').value;
        if(name && phone) {
            localStorage.setItem('agencyName', name);
            localStorage.setItem('agencyPhone', phone);
            showSitesStep();
        } else { alert('Ø¨Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©'); }
    }

    function showSitesStep() {
        document.getElementById('agencyStep').classList.add('hidden');
        document.getElementById('sitesStep').classList.remove('hidden');
        document.getElementById('currentAgencyName').innerText = localStorage.getItem('agencyName');
        loadMySites();
    }

    if(localStorage.getItem('agencyName')) { showSitesStep(); }

    function resetAgency() { 
        if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙƒØ§Ù„Ø© Ø§Ù„Ù…Ø³Ø¬Ù„Ø© Ù…Ø­Ù„ÙŠØ§Ù‹')) {
            localStorage.clear(); 
            location.reload(); 
        }
    }

    function getLocation() {
        const btn = event.target;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ¯...';
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition((p) => {
                document.getElementById('locationInput').value = p.coords.latitude.toFixed(5) + "," + p.coords.longitude.toFixed(5);
                btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯';
            });
        }
    }

    function loadMySites() {
        const list = document.getElementById('sitesList');
        
        // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (Ø³ÙŠØªÙ… Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ø§Ù„Ø´ÙŠØª Ù„Ø§Ø­Ù‚Ø§Ù‹)
        const dummyData = [
            { name: "Ù„ÙˆØ­Ø© ÙƒÙˆØ¨Ø±ÙŠ Ø³ØªØ§Ù†Ù„ÙŠ", date: "2024-01-10", views: 1540, clicks: 89 },
            { name: "Ù„ÙˆØ­Ø© Ø´Ø§Ø±Ø¹ ÙÙˆØ²ÙŠ Ù…Ø¹Ø§Ø°", date: "2023-11-20", views: 850, clicks: 12 }
        ];

        list.innerHTML = dummyData.map(site => {
            const uploadDate = new Date(site.date);
            const today = new Date();
            const diffDays = Math.ceil(Math.abs(today - uploadDate) / (1000 * 60 * 60 * 24));
            const remaining = 90 - diffDays;
            
            const isExpired = remaining <= 0;
            const statusClass = isExpired ? "status-expired" : "status-free";
            const statusLabel = isExpired ? "Ù…Ø·Ù„ÙˆØ¨ Ø§Ù„Ø¯ÙØ¹" : "ÙØªØ±Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©";
            const remainingDisplay = isExpired ? "Ø§Ù†ØªÙ‡Øª" : remaining + " ÙŠÙˆÙ…";
            const urgentClass = (!isExpired && remaining < 10) ? "urgent" : "";

            return `<tr>
                <td style="font-weight:bold;">${site.name}</td>
                <td><div class="stat-box"><i class="far fa-eye"></i> ${site.views.toLocaleString()}</div></td>
                <td><div class="click-box"><i class="fab fa-whatsapp"></i> ${site.clicks.toLocaleString()}</div></td>
                <td class="countdown ${urgentClass}">${remainingDisplay}</td>
                <td><span class="status-badge ${statusClass}">${statusLabel}</span></td>
            </tr>`;
        }).join('');
    }

    document.getElementById('uploadForm').onsubmit = (e) => {
        e.preventDefault();
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù„ÙˆØ­Ø©! Ø³ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù…Ø¬Ø±Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.");
    };
</script>

</body>
</html>
