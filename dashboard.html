<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trend Adv | Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù„ÙˆØ­Ø§Øª</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --main: #00bcd4; --bg: #f0f2f5; --card: #ffffff; --text: #1c1e21; --accent: #ff9800; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; }
        .header { width: 100%; background: #1a1a1a; color: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        .back-btn { color: white; text-decoration: none; font-size: 14px; border: 1px solid #444; padding: 6px 15px; border-radius: 20px; transition: 0.3s; }
        .add-btn { margin-top: 40px; background: var(--main); color: white; border: none; padding: 15px 35px; border-radius: 50px; font-size: 18px; font-weight: bold; cursor: pointer; box-shadow: 0 8px 20px rgba(0,188,212,0.3); transition: 0.3s; display: flex; align-items: center; gap: 10px; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: var(--card); width: 100%; max-width: 500px; padding: 30px; border-radius: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); position: relative; max-height: 90vh; overflow-y: auto; }
        .form-group { margin-bottom: 15px; }
        label { font-size: 13px; font-weight: bold; display: block; margin-bottom: 5px; color: #555; }
        input[type="text"], input[type="tel"], input[type="file"] { width: 100%; padding: 12px; border: 1.5px solid #eee; border-radius: 12px; box-sizing: border-box; font-size: 14px; background: #fafafa; }
        .gps-btn { background: #4caf50; color: white; border: none; padding: 8px 15px; border-radius: 8px; font-size: 12px; cursor: pointer; margin-top: 5px; width: 100%; }
        .payment-info { background: #fff3e0; border: 1px dashed var(--accent); padding: 10px; border-radius: 10px; margin: 15px 0; font-size: 13px; color: #e65100; text-align: center; }
        .submit-btn { width: 100%; background: var(--main); color: white; border: none; padding: 15px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .cancel-btn { width: 100%; background: none; color: #999; border: none; padding: 10px; cursor: pointer; font-size: 14px; }
    </style>
</head>
<body>

    <header class="header">
        <div style="font-weight: bold; font-size: 20px;">Trend Adv <span style="font-weight: normal; font-size: 14px; opacity: 0.7;">Business</span></div>
        <a href="index.html" class="back-btn"><i class="fas fa-arrow-right"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØµØ©</a>
    </header>

    <button class="add-btn" id="openModal">
        <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹ Ø¥Ø¹Ù„Ø§Ù†ÙŠ Ø¬Ø¯ÙŠØ¯
    </button>

    <div id="adModal" class="modal">
        <div class="modal-content">
            <h3>ğŸš€ ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
            
            <div class="payment-info">
                <i class="fas fa-info-circle"></i> Ø±Ø³ÙˆÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹: <strong>100 Ø¬.Ù…</strong> / Ø´Ù‡Ø±ÙŠØ§Ù‹
            </div>

            <form id="uploadForm">
                <div class="form-group">
                    <label>ğŸ¢ Ø§Ø³Ù… Ø§Ù„ÙˆÙƒØ§Ù„Ø© Ø§Ù„Ù…Ø§Ù„ÙƒØ©:</label>
                    <input type="text" name="agencyName" placeholder="Ù…Ø«Ø§Ù„: ÙˆÙƒØ§Ù„Ø© ØªØ±Ù†Ø¯ Ù„Ù„Ø¯Ø¹Ø§ÙŠØ©" required>
                </div>

                <div class="form-group">
                    <label>ğŸ“ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙˆØµÙÙŠ:</label>
                    <input type="text" name="siteName" placeholder="Ù…Ø«Ø§Ù„: Ù„ÙˆØ­Ø© ÙƒÙˆØ¨Ø±ÙŠ Ø³ØªØ§Ù†Ù„ÙŠ - Ø§ØªØ¬Ø§Ù‡ Ù…Ø­Ø·Ø© Ø§Ù„Ø±Ù…Ù„" required>
                </div>

                <div class="form-group">
                    <label>ğŸ—ºï¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ (GPS):</label>
                    <input type="text" id="locationInput" name="location" placeholder="Ø³ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" required readonly>
                    <button type="button" class="gps-btn" onclick="getLocation()"><i class="fas fa-map-marker-alt"></i> ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø§Ù„Ø¢Ù†</button>
                </div>

                <div class="form-group">
                    <label>ğŸ“ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„ØªÙˆØ§ØµÙ„ (Ù„Ù„Ø¬Ù…Ù‡ÙˆØ±):</label>
                    <input type="tel" name="phone" placeholder="010xxxxxxxx" required>
                </div>

                <div class="form-group">
                    <label>ğŸ–¼ï¸ ØµÙˆØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© (Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©):</label>
                    <input type="file" name="img1" accept="image/*" required>
                </div>

                <div class="form-group">
                    <label>ğŸ›¡ï¸ ØµÙˆØ±Ø© QR Ø§Ù„ØªØ±Ø®ÙŠØµ (Ù„Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ©):</label>
                    <input type="file" name="qr" accept="image/*" required>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">Ø­ÙØ¸ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ ğŸ’°</button>
                <button type="button" class="cancel-btn" id="closeModal">Ø¥Ù„ØºØ§Ø¡</button>
            </form>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwDFvV3u1Y9RhRxth7fEMzvyHhkE5K2jf0wdHrjNpBcsv3nywltpcWsgHXQABUdYYV2/exec';
        const modal = document.getElementById('adModal');
        const form = document.getElementById('uploadForm');
        const submitBtn = document.getElementById('submitBtn');

        document.getElementById('openModal').onclick = () => modal.style.display = 'flex';
        document.getElementById('closeModal').onclick = () => modal.style.display = 'none';

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù€ GPS Ø§Ù„Ø°ÙƒÙŠØ©
        function getLocation() {
            const btn = event.target;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª...';
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    document.getElementById('locationInput').value = position.coords.latitude + "," + position.coords.longitude;
                    btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­';
                    btn.style.background = '#2e7d32';
                }, () => {
                    alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù€ GPS ÙÙŠ Ù…ÙˆØ¨Ø§ÙŠÙ„Ùƒ");
                    btn.innerHTML = '<i class="fas fa-redo"></i> Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                });
            }
        }

        const toBase64 = file => new Promise((resolve, reject) => {
            if (!file) resolve(""); 
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result.split(',')[1]);
            reader.onerror = error => reject(error);
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...';

            try {
                const f1 = form.img1.files[0];
                const fqr = form.qr.files[0];

                const payload = {
                    agencyName: form.agencyName.value,
                    siteName: form.siteName.value,
                    location: form.location.value,
                    phone: form.phone.value,
                    imgData1: await toBase64(f1),
                    qrData: await toBase64(fqr)
                };

                await fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(payload)
                });

                alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙƒÙ… Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ù„ÙˆØ­Ø© âœ…');
                location.reload();

            } catch (err) {
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±ÙØ¹ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
