<!DOCTYPE html>
<html lang="ar" dir="rtl" id="appFrame">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Trend Adv | The Future of Out-of-Home Ads</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        :root { --main: #004e92; --gold: #ffcc00; --dark: #000428; --white: #ffffff; }
        body { font-family: 'Cairo', sans-serif; background: #f4f7f9; margin: 0; padding-bottom: 90px; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .promo-header { background: var(--dark); color: white; padding: 10px 0; font-size: 13px; position: sticky; top: 0; z-index: 2000; border-bottom: 2px solid var(--gold); }

        /* Ù‡ÙŠØ¯Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
        .app-top { background: linear-gradient(135deg, var(--dark), var(--main)); padding: 25px 20px; border-radius: 0 0 40px 40px; color: white; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .top-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .lang-btn { background: var(--gold); border: none; padding: 7px 15px; border-radius: 20px; font-weight: 900; cursor: pointer; color: black; }

        /* Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« */
        .search-area { background: white; border-radius: 30px; display: flex; padding: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .search-area input { flex: 1; border: none; padding: 12px 15px; outline: none; border-radius: 30px; font-size: 14px; font-weight: bold; }
        .search-trigger { background: var(--gold); border: none; width: 45px; height: 45px; border-radius: 50%; color: black; cursor: pointer; }

        /* Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        #map { height: 300px; width: 92%; margin: 20px auto; border-radius: 25px; border: 3px solid white; box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .triangle-marker { width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 20px solid var(--gold); filter: drop-shadow(0 2px 3px rgba(0,0,0,0.4)); }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .dashboard { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .dash-item { background: white; padding: 15px 5px; border-radius: 20px; text-align: center; text-decoration: none; color: var(--dark); font-size: 10px; font-weight: 900; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .dash-item i { font-size: 22px; color: var(--main); display: block; margin-bottom: 7px; }

        /* Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        .ad-card { background: white; border-radius: 25px; margin: 15px; overflow: hidden; display: flex; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.06); border: 1px solid #eee; }
        .dist-tag { position: absolute; top: 10px; left: 10px; background: var(--gold); padding: 4px 10px; border-radius: 10px; font-size: 10px; font-weight: 900; z-index: 5; }
        .ad-card img { width: 100px; height: 100px; object-fit: cover; }
        .ad-info { padding: 12px; flex: 1; }
        .ad-info h3 { margin: 0; font-size: 15px; color: var(--main); }
        .book-btn { background: var(--main); color: white; border: none; padding: 8px; border-radius: 10px; width: 100%; margin-top: 8px; font-weight: 900; cursor: pointer; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙˆØ§ØµÙ„ */
        .nav-footer { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #ddd; z-index: 2500; }
        
        [dir="ltr"] .dist-tag { left: auto; right: 10px; }
    </style>
</head>
<body>

<div class="promo-header">
    <marquee id="marquee">ğŸ“¢ Ø¹Ø±Ø¶ Ø­ØµØ±ÙŠ Ù„Ù„ÙˆÙƒØ§Ù„Ø§Øª: Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù† ÙˆØ§Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø§ØªÙƒ Ù…Ø¬Ø§Ù†Ø§Ù‹ Ù„Ù…Ø¯Ø© 3 Ø´Ù‡ÙˆØ±! | Trend Adv Ø¨ÙˆØ§Ø¨ØªÙƒ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø¢Ù„Ø§Ù Ø§Ù„Ù…Ø¹Ù„Ù†ÙŠÙ†.</marquee>
</div>

<div class="app-top">
    <div class="top-row">
        <span style="font-size: 1.5rem; font-weight: 900;">TREND ADV</span>
        <button class="lang-btn" onclick="switchLang()" id="lBtn">English</button>
    </div>
    <div class="search-area">
        <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù†Ùƒ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ..." onkeyup="runRadar()">
        <button class="search-trigger" onclick="runRadar()"><i class="fa fa-location-arrow"></i></button>
    </div>
</div>

<div id="map"></div>

<div class="dashboard">
    <a href="#" class="dash-item"><i class="fa fa-building-user"></i><span data-i18n="agency">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆÙƒØ§Ù„Ø§Øª</span></a>
    <a href="#" class="dash-item"><i class="fa fa-chart-line"></i><span data-i18n="dash">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span></a>
    <a href="#" class="dash-item"><i class="fa fa-file-excel"></i><span data-i18n="sheet">Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª</span></a>
    <a href="#" class="dash-item"><i class="fa fa-plus-circle"></i><span data-i18n="add">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†</span></a>
    <a href="#" class="dash-item"><i class="fa fa-info-circle"></i><span data-i18n="about">Ù…Ù† Ù†Ø­Ù†</span></a>
    <a href="#" class="dash-item"><i class="fa fa-headset"></i><span data-i18n="support">Ø§Ù„Ø¯Ø¹Ù…</span></a>
</div>

<div id="adsList"></div>

<div class="nav-footer">
    <a href="https://wa.me/201027676344" style="color:#25d366"><i class="fab fa-whatsapp"></i></a>
    <a href="#" style="color:#1877f2"><i class="fab fa-facebook"></i></a>
    <a href="#" style="color:#0a66c2"><i class="fab fa-linkedin"></i></a>
    <a href="#" style="color:#ff0000"><i class="fab fa-youtube"></i></a>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (Mock Data) Ø¹Ø´Ø§Ù† Ø§Ù„Ø²Ø±Ø§ÙŠØ± ØªØ´ØªØºÙ„ ÙÙˆØ±Ø§Ù‹
    const mockData = [
        { name: "Ø¥Ø¹Ù„Ø§Ù† ÙƒÙˆØ¨Ø±ÙŠ Ø£ÙƒØªÙˆØ¨Ø± - Ø¹Ø¨Ø¯Ø§Ù„Ù…Ù†Ø¹Ù… Ø±ÙŠØ§Ø¶", lat: 30.0490, lng: 31.2330, loc: "ÙˆØ³Ø· Ø§Ù„Ø¨Ù„Ø¯", img: "https://picsum.photos/100" },
        { name: "Ø´Ø§Ø´Ø© ÙŠÙˆÙ†ÙŠØ¨ÙˆÙ„ - Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø³ÙˆÙŠØ³", lat: 30.0700, lng: 31.4500, loc: "Ø§Ù„ØªØ¬Ù…Ø¹ Ø§Ù„Ø®Ø§Ù…Ø³", img: "https://picsum.photos/101" },
        { name: "Ù„ÙˆØ­Ø© Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ", lat: 30.0100, lng: 31.0200, loc: "Ø§Ù„Ø´ÙŠØ® Ø²Ø§ÙŠØ¯", img: "https://picsum.photos/102" }
    ];

    let map, userLoc, markersLayer, currentLang = 'ar';

    const langSet = {
        ar: { agency: "Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆÙƒØ§Ù„Ø§Øª", dash: "Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…", sheet: "Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª", add: "Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†", about: "Ù…Ù† Ù†Ø­Ù†", support: "Ø§Ù„Ø¯Ø¹Ù…", holder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù†Ùƒ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ...", unit: "Ù…ØªØ±", book: "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†", promo: "ğŸ“¢ Ø¹Ø±Ø¶ Ø­ØµØ±ÙŠ Ù„Ù„ÙˆÙƒØ§Ù„Ø§Øª: Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù† ÙˆØ§Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø§ØªÙƒ Ù…Ø¬Ø§Ù†Ø§Ù‹ Ù„Ù…Ø¯Ø© 3 Ø´Ù‡ÙˆØ±!" },
        en: { agency: "Agencies", dash: "Dashboard", sheet: "G-Sheet", add: "Post Ad", about: "About Us", support: "Support", holder: "Search ads in your area...", unit: "m", book: "Book Now", promo: "ğŸ“¢ Agency Exclusive: Join now and display your boards FREE for 3 months!" }
    };

    function switchLang() {
        currentLang = (currentLang === 'ar') ? 'en' : 'ar';
        const t = langSet[currentLang];
        document.getElementById('appFrame').dir = (currentLang === 'ar') ? 'rtl' : 'ltr';
        document.getElementById('lBtn').innerText = (currentLang === 'ar') ? 'English' : 'Ø¹Ø±Ø¨ÙŠ';
        document.getElementById('searchInput').placeholder = t.holder;
        document.getElementById('marquee').innerText = t.promo;
        document.querySelectorAll('[data-i18n]').forEach(el => el.innerText = t[el.getAttribute('data-i18n')]);
        runRadar();
    }

    function init() {
        map = L.map('map', { zoomControl: false }).setView([30.0444, 31.2357], 11);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
        markersLayer = L.layerGroup().addTo(map);

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(p => {
                userLoc = { lat: p.coords.latitude, lng: p.coords.longitude };
                map.setView([userLoc.lat, userLoc.lng], 13);
                L.circle([userLoc.lat, userLoc.lng], { radius: 100, color: '#004e92' }).addTo(map);
                runRadar();
            }, () => runRadar());
        } else { runRadar(); }
    }

    function calcDist(lat1, lon1, lat2, lon2) {
        const R = 6371e3;
        const dLat = (lat2-lat1)*Math.PI/180;
        const dLon = (lon2-lon1)*Math.PI/180;
        const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
        return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    }

    function runRadar() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        let list = mockData.map(ad => ({
            ...ad,
            distance: userLoc ? calcDist(userLoc.lat, userLoc.lng, ad.lat, ad.lng) : 0
        })).sort((a, b) => a.distance - b.distance);

        const filtered = list.filter(ad => ad.name.toLowerCase().includes(query) || ad.loc.toLowerCase().includes(query));
        
        const gal = document.getElementById('adsList');
        gal.innerHTML = "";
        markersLayer.clearLayers();

        filtered.forEach(ad => {
            const distTxt = ad.distance < 1000 ? `${Math.round(ad.distance)} ${langSet[currentLang].unit}` : `${(ad.distance/1000).toFixed(1)} km`;
            
            gal.innerHTML += `
                <div class="ad-card">
                    <span class="dist-tag">${distTxt}</span>
                    <img src="${ad.img}">
                    <div class="ad-info">
                        <h3>${ad.name}</h3>
                        <p style="font-size:11px; color:#777; margin:5px 0;">${ad.loc}</p>
                        <button class="book-btn" onclick="window.open('https://wa.me/201027676344')">${langSet[currentLang].book}</button>
                    </div>
                </div>`;

            const icon = L.divIcon({ className: 'triangle-marker', iconSize: [20, 20] });
            L.marker([ad.lat, ad.lng], { icon: icon }).addTo(markersLayer).bindPopup(ad.name);
        });
    }

    window.onload = init;
</script>
</body>
</html>
